import express from 'express';
import * as vulnerabilityController from '../controllers/vulnerability.controller.js';
// import { 
//   validateCreateVulnerability,
//   validateUpdateVulnerability,
//   validateAddNote,
//   validateMarkFalsePositive,
//   validateResolveVulnerability,
//   validateGetVulnerabilities,
//   validateExportVulnerabilities
// } from '../middleware/vulnerability.validation.js';

const router = express.Router();

// Statistics endpoint
router.get('/stats', vulnerabilityController.getVulnerabilityStats);

// Export endpoint
router.get('/export', vulnerabilityController.exportVulnerabilities);

// Details endpoint - DEPRECATED: Use GET /vulnerabilities?include=details instead
router.get('/:id/details', vulnerabilityController.getVulnerabilityDetails);

// Main CRUD routes - Consolidated route that handles search, filters, sorting
router.get('/', vulnerabilityController.getVulnerabilities);
router.get('/:id', vulnerabilityController.getVulnerability);
router.patch('/:id', vulnerabilityController.updateVulnerability);

// Action endpoints
router.post('/:id/notes', vulnerabilityController.addNote);
router.post('/:id/false-positive', vulnerabilityController.markAsFalsePositive);
router.post('/:id/resolve', vulnerabilityController.resolveVulnerability);
router.post("/:id/send-to-vm", vulnerabilityController.transferVulnToVM);
router.post("/:id/suppress", vulnerabilityController.suppressVuln);
router.post("/:id/unsuppress", vulnerabilityController.unSuppressVuln);

export default router;